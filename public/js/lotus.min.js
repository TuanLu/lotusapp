!function(e){function t(t){for(var n,i,l=t[0],o=t[1],d=t[2],h=0,u=[];h<l.length;h++)i=l[h],r[i]&&u.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);u.length;)u.shift()();return s.push.apply(s,d||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],n=!0,l=1;l<a.length;l++){var o=a[l];0!==r[o]&&(n=!1)}n&&(s.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},r={1:0},s=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var l=window.webpackJsonp=window.webpackJsonp||[],o=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var c=o;s.push([345,0]),a()}({178:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(9),i=a.n(s),l=a(53),o=a(61),d=a(10),c=a(17),h=a(62);var u={START_APP:"START_APP",UPDATE_STATE_DATA:"UPDATE_STATE_DATA"};const p=e=>({type:u.UPDATE_STATE_DATA,updateData:e});h.a.SubMenu;var m,g,f=class extends r.a.Component{renderMenuItem(){let e=this.props.mainState;return e.defaultRouter,e.userRoles.map((e,t)=>r.a.createElement(h.a.Item,{onClick:()=>{this.props.dispatch(p({defaultRouter:e.path}))},key:e.path},r.a.createElement(c.a,{type:e.icon}),r.a.createElement("span",null,e.label)))}render(){let e=this.props.mainState.defaultRouter;return r.a.createElement("div",null,r.a.createElement(h.a,{defaultSelectedKeys:[e],mode:"inline",theme:"dark"},this.renderMenuItem()))}},y=a(32),E=a(63),v=a(20),S=a(22),x=a(31),k=a(40),I=a(30),b=a(64);Object.assign;window.ISD_BASE_URL&&""!=window.ISD_BASE_URL||(window.ISD_BASE_URL=window.location.protocol+"//"+(m=document.location.href,null!=(g=m.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i))&&g.length>2&&"string"==typeof g[2]&&g[2].length>0?g[2]:null)+"/");const C=()=>{let e=sessionStorage.getItem("ISD_TOKEN");if(""!=e&&null!=e)return{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e}},w=[{value:"0",text:"Ngừng kích hoạt"},{value:"1",text:"Kích hoạt"}];var D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};function T(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}const O=S.a.Item,_=r.a.createContext(),j=S.a.create()(e=>{let t=e.form,a=(e.index,T(e,["form","index"]));return r.a.createElement(_.Provider,{value:t},r.a.createElement("tr",a))});class N extends r.a.Component{constructor(...e){var t;return t=super(...e),this.getInput=(()=>{switch(this.props.inputType){case"ranking":return r.a.createElement(I.a,{placeholder:"Chọn xếp hạng"},r.a.createElement(I.a.Option,{value:"A"},"A"),r.a.createElement(I.a.Option,{value:"B"},"B"),r.a.createElement(I.a.Option,{value:"C"},"C"),r.a.createElement(I.a.Option,{value:"D"},"D"));default:return r.a.createElement(k.a,null)}}),t}render(){var e=this.props;const t=e.editing,a=e.required,n=e.dataIndex,s=e.title,i=(e.inputType,e.record),l=(e.index,T(e,["editing","required","dataIndex","title","inputType","record","index"]));return r.a.createElement(_.Consumer,null,e=>{const o=e.getFieldDecorator;return r.a.createElement("td",l,t?r.a.createElement(O,{style:{margin:0}},o(n,{rules:[{required:a,message:`Hãy nhập dữ liệu ô ${s}!`}],initialValue:i[n]})(this.getInput())):l.children)})}}var q=class extends r.a.Component{constructor(e){super(e),this.isEditing=(e=>e.key===this.state.editingKey),this.cancel=(()=>{this.setState({editingKey:""})}),this.delete=(e=>{if(e.id)fetch(ISD_BASE_URL+"npp/deleteNpp/"+e.id,{headers:C()}).then(e=>e.json()).then(e=>{if("error"==e.status)d.a.error("Có lỗi xảy ra khi xoá nhà phân phối!",3);else{let t=this.state.data.filter(t=>t.id!=e.data);this.setState({data:t}),d.a.success(e.message)}}).catch(e=>{d.a.error("Có lỗi xảy ra khi xoá nhà phân phối!",3),console.log(e)});else if(e.key){let t=this.state.data.filter(t=>t.key!=e.key);this.setState({data:t})}}),this.state={data:[],editingKey:""},this.columns=[{title:"Mã NPP",dataIndex:"ma_npp",width:"10%",editable:!0,required:!0},{title:"Tên",dataIndex:"name",editable:!0,required:!0},{title:"Địa chỉ",dataIndex:"address",editable:!0,required:!0},{title:"Điện thoại",dataIndex:"phone",editable:!0},{title:"Xếp hạng",dataIndex:"ranking",editable:!0},{title:"Actions",dataIndex:"operation",render:(e,t)=>{const a=this.isEditing(t);return r.a.createElement("div",{style:{minWidth:100}},a?r.a.createElement("span",null,r.a.createElement(_.Consumer,null,e=>r.a.createElement("a",{href:"javascript:;",onClick:()=>this.save(e,t.key),style:{marginRight:8}},"Lưu")),r.a.createElement(y.a,{title:"Bạn thật sự muốn huỷ?",onConfirm:()=>this.cancel(t.key)},r.a.createElement("a",{href:"javascript:;"},"Huỷ"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{href:"javascript:;",onClick:()=>this.edit(t.key)},"Sửa")," | ",r.a.createElement(y.a,{title:"Bạn thật sự muốn xoá?",okType:"danger",onConfirm:()=>this.delete(t)},r.a.createElement("a",{href:"javascript:;"},"Xoá"))))}}]}addNewRow(){let e=this.getDefaultFields();e=D({},e,{key:this.state.data.length+1}),this.setState({data:[e,...this.state.data],editingKey:e.key})}getDefaultFields(){return{ma_npp:"",name:"",address:"",phone:"",ranking:"A"}}edit(e){this.setState({editingKey:e})}save(e,t){e.validateFields((e,a)=>{if(e)return;const n=[...this.state.data],r=n.findIndex(e=>t===e.key);if(r>-1){const e=n[r];let t=D({},e,a);fetch(ISD_BASE_URL+"npp/updateNpp",{method:"POST",headers:C(),body:JSON.stringify(t)}).then(e=>e.json()).then(e=>{"error"==e.status?(d.a.error(e.message,3),e.show_login&&this.props.dispatch(p({showLogin:!0}))):(n.splice(r,1,D({},t,e.data)),this.setState({data:n,editingKey:""}),d.a.success(e.message))}).catch(e=>{console.log("parsing failed",e),d.a.error("Có lỗi xảy ra trong quá trình lưu hoặc chỉnh sửa!")})}else n.push(data),this.setState({data:n,editingKey:""})})}fetchData(){fetch(ISD_BASE_URL+"npp/fetchNpp",{headers:C()}).then(e=>e.json()).then(e=>{if("error"==e.status)d.a.warning(e.message,3);else if(e.data){let t=e.data.map((e,t)=>D({},e,{key:t}));this.setState({data:t})}}).catch(e=>{d.a.error("Có lỗi khi tải dữ liệu nhà phân phối!",3),console.log(e)})}componentDidMount(){this.fetchData()}render(){const e={body:{row:j,cell:N}},t=this.columns.map(e=>e.editable?D({},e,{onCell:t=>({record:t,inputType:e.dataIndex,dataIndex:e.dataIndex,title:e.title,editing:this.isEditing(t),required:e.required})}):e);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"table-operations"},r.a.createElement(b.a,null,r.a.createElement(x.a,{span:12},r.a.createElement("h2",{className:"head-title"},"Quản lý nhà phân phối")),r.a.createElement(x.a,{span:12},r.a.createElement("div",{className:"action-btns"},r.a.createElement(v.a,{onClick:()=>this.addNewRow(),type:"primary",icon:"plus"},"Thêm mới NPP"))))),r.a.createElement(E.a,{components:e,bordered:!0,dataSource:this.state.data,columns:t,rowClassName:"editable-row"}))}},A=a(176);const R=A.a.SHOW_PARENT;var P=Object(l.b)(e=>({mainState:e.main.present}))(class extends r.a.Component{constructor(e){super(e),this.onChange=(e=>{this.setState({value:e}),this.props.onChange&&this.props.onChange(e)}),this.state={value:this.props.selectedRoles||[],treeData:[]}}fetchData(){fetch(ISD_BASE_URL+"fetchAllRoles").then(e=>e.json()).then(e=>{e.data?(this.setState({treeData:e.data}),this.props.dispatch(p({allUserRoles:e.data}))):console.warn(e.message)}).catch(e=>{console.log(e)})}componentDidMount(){let e=this.props.mainState.allUserRoles;e?this.setState({treeData:e}):this.fetchData()}render(){const e={treeData:this.state.treeData,value:this.state.value,onChange:this.onChange,treeCheckable:!0,showCheckedStrategy:R,searchPlaceholder:"Hãy chọn quyền",style:{width:300}};return r.a.createElement(A.a,e)}}),K=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};function L(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}const B=S.a.Item,U=r.a.createContext(),F=S.a.create()(e=>{let t=e.form,a=(e.index,L(e,["form","index"]));return r.a.createElement(U.Provider,{value:t},r.a.createElement("tr",a))});class H extends r.a.Component{constructor(...e){var t;return t=super(...e),this.getInput=(()=>{switch(this.props.inputType){case"status":return r.a.createElement(I.a,{placeholder:"Chọn xếp hạng"},w.map(e=>r.a.createElement(I.a.Option,{key:e.value,key:e.value},e.text)));case"hash":return r.a.createElement(k.a,{type:"password",placeholder:"Nhập mật khẩu"});case"roles":let e=[];return this.props.record&&this.props.record.roles&&""!=this.props.record.roles&&(e=this.props.record.roles.split(",")),r.a.createElement(P,{selectedRoles:e});default:return r.a.createElement(k.a,null)}}),t}render(){var e=this.props;const t=e.editing,a=e.required,n=e.dataIndex,s=e.title,i=(e.inputType,e.record),l=(e.index,L(e,["editing","required","dataIndex","title","inputType","record","index"]));return r.a.createElement(U.Consumer,null,e=>{const o=e.getFieldDecorator;return r.a.createElement("td",l,t?r.a.createElement(B,{style:{margin:0}},o(n,{rules:(e=>{let t=[{required:a,message:`Hãy nhập dữ liệu ô ${s}!`}];return"email"==n&&(t=[...t,{type:"email",message:"Email không hợp lệ"}]),t})(),initialValue:i[n]})(this.getInput())):l.children)})}}var M=class extends r.a.Component{constructor(e){super(e),this.isEditing=(e=>e.key===this.state.editingKey),this.cancel=(()=>{this.setState({editingKey:""})}),this.delete=(e=>{if(e.id)fetch(ISD_BASE_URL+"users/deleteUser/"+e.id,{headers:C()}).then(e=>e.json()).then(e=>{if("error"==e.status)d.a.error(response.message,3);else{let t=this.state.data.filter(t=>t.id!=e.data);this.setState({data:t}),d.a.success(e.message)}}).catch(e=>{d.a.error("Có lỗi xảy ra khi xoá user!",3),console.log(e)});else if(e.key){let t=this.state.data.filter(t=>t.key!=e.key);this.setState({data:t})}}),this.state={data:[],editingKey:""},this.columns=[{title:"Tên đăng nhập",dataIndex:"username",editable:!0,required:!0},{title:"Email",dataIndex:"email",editable:!0,required:!0},{title:"Mật khẩu",dataIndex:"hash",editable:!0,required:!1,render:(e,t)=>"Đã mã hoá"},{title:"Họ và tên",dataIndex:"name",editable:!0,required:!1},{title:"Quyền",dataIndex:"roles",editable:!0,required:!1},{title:"Trạng thái",dataIndex:"status",editable:!0,render:(e,t)=>{let a=w.filter(t=>t.value==e);return r.a.createElement("span",null,a[0].text)}},{title:"Actions",dataIndex:"operation",render:(e,t)=>{const a=this.isEditing(t);return r.a.createElement("div",{style:{minWidth:100}},a?r.a.createElement("span",null,r.a.createElement(U.Consumer,null,e=>r.a.createElement("a",{href:"javascript:;",onClick:()=>this.save(e,t.key),style:{marginRight:8}},"Lưu")),r.a.createElement(y.a,{title:"Bạn thật sự muốn huỷ?",onConfirm:()=>this.cancel(t.key)},r.a.createElement("a",{href:"javascript:;"}," "," | ","Huỷ"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{href:"javascript:;",onClick:()=>this.edit(t.key)},"Sửa")," | ",r.a.createElement(y.a,{title:"Bạn thật sự muốn xoá?",okType:"danger",onConfirm:()=>this.delete(t)},r.a.createElement("a",{href:"javascript:;"},"Xoá"))))}}]}addNewRow(){let e=this.getDefaultFields();e=K({},e,{key:this.state.data.length+1}),this.setState({data:[e,...this.state.data],editingKey:e.key})}getDefaultFields(){return{username:"",email:"",name:"",hash:"",status:"1",roles:[]}}edit(e){this.setState({editingKey:e})}save(e,t){e.validateFields((e,a)=>{if(e)return;const n=[...this.state.data],r=n.findIndex(e=>t===e.key);if(r>-1){const e=n[r];let t=K({},e,a);fetch(ISD_BASE_URL+"users/updateUser",{method:"POST",headers:C(),body:JSON.stringify(t)}).then(e=>e.json()).then(e=>{"error"==e.status?(d.a.error(e.message,3),e.show_login&&this.props.dispatch(p({showLogin:!0}))):(n.splice(r,1,K({},t,e.data)),this.setState({data:n,editingKey:""}),d.a.success(e.message))}).catch(e=>{console.log("parsing failed",e),d.a.error("Có lỗi xảy ra trong quá trình lưu hoặc chỉnh sửa!")})}else n.push(data),this.setState({data:n,editingKey:""})})}fetchData(){fetch(ISD_BASE_URL+"users/fetchUsers",{headers:C()}).then(e=>e.json()).then(e=>{if("error"==e.status)d.a.warning(e.message,3);else if(e.data){let t=e.data.map((e,t)=>K({},e,{key:t}));this.setState({data:t})}}).catch(e=>{d.a.error("Có lỗi khi tải dữ liệu nhà phân phối!",3),console.log(e)})}componentDidMount(){this.fetchData()}render(){const e={body:{row:F,cell:H}},t=this.columns.map(e=>e.editable?K({},e,{onCell:t=>({record:t,inputType:e.dataIndex,dataIndex:e.dataIndex,title:e.title,editing:this.isEditing(t),required:e.required})}):e);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"table-operations"},r.a.createElement(b.a,null,r.a.createElement(x.a,{span:12},r.a.createElement("h2",{className:"head-title"},"Quản lý người dùng")),r.a.createElement(x.a,{span:12},r.a.createElement("div",{className:"action-btns"},r.a.createElement(v.a,{onClick:()=>this.addNewRow(),type:"primary",icon:"plus"},"Thêm mới người dùng"))))),r.a.createElement(E.a,{components:e,bordered:!0,dataSource:this.state.data,columns:t,rowClassName:"editable-row"}))}},J=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};const W=S.a.Item;var V=S.a.create()(class extends r.a.Component{constructor(...e){var t;return t=super(...e),this.state={loading:!1},this.handleSubmit=(e=>{e.preventDefault(),this.props.form.validateFields((e,t)=>{e||(this.setState({loading:!0}),this.getToken(J({},t)))})}),t}getToken(e){fetch(ISD_BASE_URL+"token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{e.token?(sessionStorage.setItem("ISD_TOKEN",e.token),this.props.dispatch(p({showLogin:!1,userRoles:e.scopes||[],userInfo:e.userInfo,defaultRouter:e.scopes[0]&&e.scopes[0].path?e.scopes[0].path:""}))):(d.a.error(e.message,5),this.setState({loading:!1}))}).catch(e=>{console.warn(e),d.a.error("Có lỗi trong quá trình đăng nhập!")})}render(){const e=this.props.form.getFieldDecorator;return r.a.createElement("div",{className:"login-wrapper"},r.a.createElement("div",{className:"login-logo"},r.a.createElement("img",{src:"./images/logo.png"})),r.a.createElement(S.a,{onSubmit:this.handleSubmit,className:"login-form"},r.a.createElement(W,null,e("userName",{rules:[{required:!0,message:"Nhập tên đăng nhập!"}]})(r.a.createElement(k.a,{prefix:r.a.createElement(c.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Tên đăng nhập"}))),r.a.createElement(W,null,e("password",{rules:[{required:!0,message:"Nhập mật khẩu!"}]})(r.a.createElement(k.a,{prefix:r.a.createElement(c.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Mật khẩu"}))),r.a.createElement(W,null,r.a.createElement(v.a,{loading:this.state.loading,type:"primary",htmlType:"submit",className:"login-form-button"},"Đăng nhập"))))}});var X=class extends r.a.Component{showUserName(){let e=this.props.mainState.userInfo;if(e)return e.name||e.username||e.email}render(){return r.a.createElement("div",{className:"admin-user-info"},r.a.createElement("span",null,"Xin chao, ",r.a.createElement("b",null,this.showUserName())),r.a.createElement(v.a,{onClick:()=>{this.props.dispatch(p({showLogin:!0}))},type:"primary",ghost:!0},"Logout"))}},Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};class $ extends r.a.Component{render(){return r.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},className:"isd-app-loading"},r.a.createElement(c.a,{style:Q({fontSize:46,color:"#08c",width:"100%"},this.props.style),type:"loading"}))}}var G=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};function z(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}const Y=S.a.Item,Z=r.a.createContext(),ee=S.a.create()(e=>{let t=e.form,a=(e.index,z(e,["form","index"]));return r.a.createElement(Z.Provider,{value:t},r.a.createElement("tr",a))});class te extends r.a.Component{constructor(...e){var t;return t=super(...e),this.getInput=(()=>(this.props.inputType,r.a.createElement(k.a,null))),t}render(){var e=this.props;const t=e.editing,a=e.required,n=e.dataIndex,s=e.title,i=(e.inputType,e.record),l=(e.index,z(e,["editing","required","dataIndex","title","inputType","record","index"]));return r.a.createElement(Z.Consumer,null,e=>{const o=e.getFieldDecorator;return r.a.createElement("td",l,t?r.a.createElement(Y,{style:{margin:0}},o(n,{rules:[{required:a,message:`Hãy nhập dữ liệu ô ${s}!`}],initialValue:i[n]})(this.getInput())):l.children)})}}var ae=class extends r.a.Component{constructor(e){super(e),this.isEditing=(e=>e.key===this.state.editingKey),this.cancel=(()=>{this.setState({editingKey:""})}),this.delete=(e=>{if(e.id)fetch(ISD_BASE_URL+"qlkho/deleteKho/"+e.id,{headers:C()}).then(e=>e.json()).then(e=>{if("error"==e.status)d.a.error("Có lỗi xảy ra khi xoá dữ liệu kho!",3);else{let t=this.state.data.filter(t=>t.id!=e.data);this.setState({data:t}),d.a.success(e.message)}}).catch(e=>{d.a.error("Có lỗi xảy ra khi xoá dữ liệu kho!",3),console.log(e)});else if(e.key){let t=this.state.data.filter(t=>t.key!=e.key);this.setState({data:t})}}),this.state={data:[],editingKey:""},this.columns=[{title:"Mã Kho",dataIndex:"ma_kho",width:"10%",editable:!0,required:!0},{title:"Tên",dataIndex:"name",editable:!0,required:!0},{title:"Thông tin",dataIndex:"description",editable:!0,required:!0},{title:"Actions",dataIndex:"operation",render:(e,t)=>{const a=this.isEditing(t);return r.a.createElement("div",{style:{minWidth:100}},a?r.a.createElement("span",null,r.a.createElement(Z.Consumer,null,e=>r.a.createElement("a",{href:"javascript:;",onClick:()=>this.save(e,t.key),style:{marginRight:8}},"Lưu")),r.a.createElement(y.a,{title:"Bạn thật sự muốn huỷ?",onConfirm:()=>this.cancel(t.key)},r.a.createElement("a",{href:"javascript:;"},"Huỷ"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{href:"javascript:;",onClick:()=>this.edit(t.key)},"Sửa")," | ",r.a.createElement(y.a,{title:"Bạn thật sự muốn xoá?",okType:"danger",onConfirm:()=>this.delete(t)},r.a.createElement("a",{href:"javascript:;"},"Xoá"))))}}]}addNewRow(){let e=this.getDefaultFields();e=G({},e,{key:this.state.data.length+1}),this.setState({data:[e,...this.state.data],editingKey:e.key})}getDefaultFields(){return{ma_kho:"",name:"",description:""}}edit(e){this.setState({editingKey:e})}save(e,t){e.validateFields((e,a)=>{if(e)return;const n=[...this.state.data],r=n.findIndex(e=>t===e.key);if(r>-1){const e=n[r];let t=G({},e,a);fetch(ISD_BASE_URL+"qlkho/updateKho",{method:"POST",headers:C(),body:JSON.stringify(t)}).then(e=>e.json()).then(e=>{"error"==e.status?d.a.error(e.message,3):(n.splice(r,1,G({},t,e.data)),this.setState({data:n,editingKey:""}),d.a.success(e.message))}).catch(e=>{console.log("parsing failed",e),d.a.error("Có lỗi xảy ra trong quá trình lưu hoặc chỉnh sửa!")})}else n.push(data),this.setState({data:n,editingKey:""})})}fetchData(){fetch(ISD_BASE_URL+"qlkho/fetchKho",{headers:C()}).then(e=>e.json()).then(e=>{if("error"==e.status)d.a.warning(e.message,3);else if(e.data){let t=e.data.map((e,t)=>G({},e,{key:t}));this.setState({data:t})}}).catch(e=>{d.a.error("Có lỗi khi tải dữ liệu dữ liệu kho!",3),console.log(e)})}componentDidMount(){this.fetchData()}render(){const e={body:{row:ee,cell:te}},t=this.columns.map(e=>e.editable?G({},e,{onCell:t=>({record:t,inputType:e.dataIndex,dataIndex:e.dataIndex,title:e.title,editing:this.isEditing(t),required:e.required})}):e);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"table-operations"},r.a.createElement(b.a,null,r.a.createElement(x.a,{span:12},r.a.createElement("h2",{className:"head-title"},"Quản lý kho")),r.a.createElement(x.a,{span:12},r.a.createElement("div",{className:"action-btns"},r.a.createElement(v.a,{onClick:()=>this.addNewRow(),type:"primary",icon:"plus"},"Thêm kho mới"))))),r.a.createElement(E.a,{components:e,bordered:!0,dataSource:this.state.data,columns:t,rowClassName:"editable-row"}))}},ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};function re(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}const se=S.a.Item,ie=r.a.createContext(),le=S.a.create()(e=>{let t=e.form,a=(e.index,re(e,["form","index"]));return r.a.createElement(ie.Provider,{value:t},r.a.createElement("tr",a))});class oe extends r.a.Component{constructor(...e){var t;return t=super(...e),this.getInput=(()=>(this.props.inputType,r.a.createElement(k.a,null))),t}render(){var e=this.props;const t=e.editing,a=e.required,n=e.dataIndex,s=e.title,i=(e.inputType,e.record),l=(e.index,re(e,["editing","required","dataIndex","title","inputType","record","index"]));return r.a.createElement(ie.Consumer,null,e=>{const o=e.getFieldDecorator;return r.a.createElement("td",l,t?r.a.createElement(se,{style:{margin:0}},o(n,{rules:[{required:a,message:`Hãy nhập dữ liệu ô ${s}!`}],initialValue:i[n]})(this.getInput())):l.children)})}}var de=class extends r.a.Component{constructor(e){super(e),this.isEditing=(e=>e.key===this.state.editingKey),this.cancel=(()=>{this.setState({editingKey:""})}),this.delete=(e=>{if(e.id)fetch(ISD_BASE_URL+"qlcate/deleteCate/"+e.id,{headers:C()}).then(e=>e.json()).then(e=>{if("error"==e.status)d.a.error("Có lỗi xảy ra khi xoá dữ liệu kho!",3);else{let t=this.state.data.filter(t=>t.id!=e.data);this.setState({data:t}),d.a.success(e.message)}}).catch(e=>{d.a.error("Có lỗi xảy ra khi xoá dữ liệu kho!",3),console.log(e)});else if(e.key){let t=this.state.data.filter(t=>t.key!=e.key);this.setState({data:t})}}),this.state={data:[],editingKey:""},this.columns=[{title:"Tên danh mục",dataIndex:"name",editable:!0,required:!0},{title:"Thông tin",dataIndex:"description",editable:!0,required:!0},{title:"Actions",dataIndex:"operation",render:(e,t)=>{const a=this.isEditing(t);return r.a.createElement("div",{style:{minWidth:100}},a?r.a.createElement("span",null,r.a.createElement(ie.Consumer,null,e=>r.a.createElement("a",{href:"javascript:;",onClick:()=>this.save(e,t.key),style:{marginRight:8}},"Lưu")),r.a.createElement(y.a,{title:"Bạn thật sự muốn huỷ?",onConfirm:()=>this.cancel(t.key)},r.a.createElement("a",{href:"javascript:;"},"Huỷ"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{href:"javascript:;",onClick:()=>this.edit(t.key)},"Sửa")," | ",r.a.createElement(y.a,{title:"Bạn thật sự muốn xoá?",okType:"danger",onConfirm:()=>this.delete(t)},r.a.createElement("a",{href:"javascript:;"},"Xoá"))))}}]}addNewRow(){let e=this.getDefaultFields();e=ne({},e,{key:this.state.data.length+1}),this.setState({data:[e,...this.state.data],editingKey:e.key})}getDefaultFields(){return{name:"",description:""}}edit(e){this.setState({editingKey:e})}save(e,t){e.validateFields((e,a)=>{if(e)return;const n=[...this.state.data],r=n.findIndex(e=>t===e.key);if(r>-1){const e=n[r];let t=ne({},e,a);fetch(ISD_BASE_URL+"qlcate/updateCate",{method:"POST",headers:C(),body:JSON.stringify(t)}).then(e=>e.json()).then(e=>{"error"==e.status?d.a.error(e.message,3):(n.splice(r,1,ne({},t,e.data)),this.setState({data:n,editingKey:""}),d.a.success(e.message))}).catch(e=>{console.log("parsing failed",e),d.a.error("Có lỗi xảy ra trong quá trình lưu hoặc chỉnh sửa!")})}else n.push(data),this.setState({data:n,editingKey:""})})}fetchData(){fetch(ISD_BASE_URL+"qlcate/fetchCate",{headers:C()}).then(e=>e.json()).then(e=>{if("error"==e.status)d.a.warning(e.message,3);else if(e.data){let t=e.data.map((e,t)=>ne({},e,{key:t}));this.setState({data:t})}}).catch(e=>{d.a.error("Có lỗi khi tải dữ liệu dữ liệu danh mục!",3),console.log(e)})}componentDidMount(){this.fetchData()}render(){const e={body:{row:le,cell:oe}},t=this.columns.map(e=>e.editable?ne({},e,{onCell:t=>({record:t,inputType:e.dataIndex,dataIndex:e.dataIndex,title:e.title,editing:this.isEditing(t),required:e.required})}):e);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"table-operations"},r.a.createElement(b.a,null,r.a.createElement(x.a,{span:12},r.a.createElement("h2",{className:"head-title"},"Quản lý Danh mục")),r.a.createElement(x.a,{span:12},r.a.createElement("div",{className:"action-btns"},r.a.createElement(v.a,{onClick:()=>this.addNewRow(),type:"primary",icon:"plus"},"Thêm mới"))))),r.a.createElement(E.a,{components:e,bordered:!0,dataSource:this.state.data,columns:t,rowClassName:"editable-row"}))}},ce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};function he(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}const ue=S.a.Item,pe=r.a.createContext(),me=S.a.create()(e=>{let t=e.form,a=(e.index,he(e,["form","index"]));return r.a.createElement(pe.Provider,{value:t},r.a.createElement("tr",a))});class ge extends r.a.Component{constructor(...e){var t;return t=super(...e),this.getInput=(()=>(this.props.inputType,r.a.createElement(k.a,null))),t}render(){var e=this.props;const t=e.editing,a=e.required,n=e.dataIndex,s=e.title,i=(e.inputType,e.record),l=(e.index,he(e,["editing","required","dataIndex","title","inputType","record","index"]));return r.a.createElement(pe.Consumer,null,e=>{const o=e.getFieldDecorator;return r.a.createElement("td",l,t?r.a.createElement(ue,{style:{margin:0}},o(n,{rules:[{required:a,message:`Hãy nhập dữ liệu ô ${s}!`}],initialValue:i[n]})(this.getInput())):l.children)})}}var fe=class extends r.a.Component{constructor(e){super(e),this.isEditing=(e=>e.key===this.state.editingKey),this.cancel=(()=>{this.setState({editingKey:""})}),this.delete=(e=>{if(e.id)fetch(ISD_BASE_URL+"qlkh/deleteKh/"+e.id,{headers:C()}).then(e=>e.json()).then(e=>{if("error"==e.status)d.a.error("Có lỗi xảy ra khi xoá dữ liệu khách hàng!",3);else{let t=this.state.data.filter(t=>t.id!=e.data);this.setState({data:t}),d.a.success(e.message)}}).catch(e=>{d.a.error("Có lỗi xảy ra khi xoá dữ liệu khách hàng!",3),console.log(e)});else if(e.key){let t=this.state.data.filter(t=>t.key!=e.key);this.setState({data:t})}}),this.state={data:[],editingKey:""},this.columns=[{title:"Mã Khách Hàng",dataIndex:"ma_kh",width:"10%",editable:!0,required:!0},{title:"Tên",dataIndex:"name",editable:!0,required:!0},{title:"Số điện thoại",dataIndex:"phone",editable:!0,required:!0},{title:"Địa chỉ",dataIndex:"adress",editable:!0,required:!0},{title:"Thông tin",dataIndex:"description",editable:!0,required:!1},{title:"Actions",dataIndex:"operation",render:(e,t)=>{const a=this.isEditing(t);return r.a.createElement("div",{style:{minWidth:100}},a?r.a.createElement("span",null,r.a.createElement(pe.Consumer,null,e=>r.a.createElement("a",{href:"javascript:;",onClick:()=>this.save(e,t.key),style:{marginRight:8}},"Lưu")),r.a.createElement(y.a,{title:"Bạn thật sự muốn huỷ?",onConfirm:()=>this.cancel(t.key)},r.a.createElement("a",{href:"javascript:;"},"Huỷ"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{href:"javascript:;",onClick:()=>this.edit(t.key)},"Sửa")," | ",r.a.createElement(y.a,{title:"Bạn thật sự muốn xoá?",okType:"danger",onConfirm:()=>this.delete(t)},r.a.createElement("a",{href:"javascript:;"},"Xoá"))))}}]}addNewRow(){let e=this.getDefaultFields();e=ce({},e,{key:this.state.data.length+1}),this.setState({data:[e,...this.state.data],editingKey:e.key})}getDefaultFields(){return{ma_kh:"",name:"",description:""}}edit(e){this.setState({editingKey:e})}save(e,t){e.validateFields((e,a)=>{if(e)return;const n=[...this.state.data],r=n.findIndex(e=>t===e.key);if(r>-1){const e=n[r];let t=ce({},e,a);fetch(ISD_BASE_URL+"qlkh/updateKh",{method:"POST",headers:C(),body:JSON.stringify(t)}).then(e=>e.json()).then(e=>{"error"==e.status?d.a.error(e.message,3):(n.splice(r,1,ce({},t,e.data)),this.setState({data:n,editingKey:""}),d.a.success(e.message))}).catch(e=>{console.log("parsing failed",e),d.a.error("Có lỗi xảy ra trong quá trình lưu hoặc chỉnh sửa!")})}else n.push(data),this.setState({data:n,editingKey:""})})}fetchData(){fetch(ISD_BASE_URL+"qlkh/fetchKh",{headers:C()}).then(e=>e.json()).then(e=>{if("error"==e.status)d.a.warning(e.message,3);else if(e.data){let t=e.data.map((e,t)=>ce({},e,{key:t}));this.setState({data:t})}}).catch(e=>{d.a.error("Có lỗi khi tải dữ liệu dữ liệu khách hàng!",3),console.log(e)})}componentDidMount(){this.fetchData()}render(){const e={body:{row:me,cell:ge}},t=this.columns.map(e=>e.editable?ce({},e,{onCell:t=>({record:t,inputType:e.dataIndex,dataIndex:e.dataIndex,title:e.title,editing:this.isEditing(t),required:e.required})}):e);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"table-operations"},r.a.createElement(b.a,null,r.a.createElement(x.a,{span:12},r.a.createElement("h2",{className:"head-title"},"Quản lý khách hàng")),r.a.createElement(x.a,{span:12},r.a.createElement("div",{className:"action-btns"},r.a.createElement(v.a,{onClick:()=>this.addNewRow(),type:"primary",icon:"plus"},"Thêm khách hàng mới"))))),r.a.createElement(E.a,{components:e,bordered:!0,dataSource:this.state.data,columns:t,rowClassName:"editable-row"}))}};const ye=o.a.Header,Ee=o.a.Sider;o.a.Content;var ve=Object(l.b)(e=>({mainState:e.main.present}))(class extends r.a.Component{constructor(...e){var t;return t=super(...e),this.state={collapsed:!0,logged:!1,loading:!0},this.toggle=(()=>{this.setState({collapsed:!this.state.collapsed})}),t}componentWillMount(){let e=this.props.mainState;if(e.userInfo)this.props.dispatch(p({defaultRouter:e.defaultRouter}));else{let e=sessionStorage.getItem("ISD_TOKEN");""!=e&&null!=e?fetch(ISD_BASE_URL+"fetchRoles",{headers:C()}).then(e=>e.json()).then(e=>{e.userInfo?this.props.dispatch(p({showLogin:!1,userRoles:e.scopes,defaultRouter:e.scopes[0]&&e.scopes[0].path?e.scopes[0].path:"",userInfo:e.userInfo})):"error"==e.status&&d.a.error(e.message,3),this.setState({loading:!1})}).catch(e=>{console.warn(e),this.setState({loading:!1})}):this.setState({loading:!1})}}renderContent(e){let t=this.props.dispatch;switch(e){case"npp":return r.a.createElement(q,{dispatch:t,mainState:this.props.mainState});case"qluser":return r.a.createElement(M,{dispatch:t,mainState:this.props.mainState});case"qlkho":return r.a.createElement(ae,{dispatch:t});case"qlcate":return r.a.createElement(de,{dispatch:t});case"qlkh":return r.a.createElement(fe,{dispatch:t})}}render(){if(this.state.loading)return r.a.createElement($,null);if(this.props.mainState.showLogin)return r.a.createElement(V,{dispatch:this.props.dispatch});let e=this.props.mainState.defaultRouter;return r.a.createElement(o.a,null,r.a.createElement(Ee,{trigger:null,collapsible:!0,collapsed:this.state.collapsed},r.a.createElement("div",{style:{color:"#fff",textAlign:"center",padding:"10px 0"},className:"logo"},r.a.createElement("img",{style:{width:"50%"},src:"./images/logo.png"})),r.a.createElement(f,{mainState:this.props.mainState,dispatch:this.props.dispatch})),r.a.createElement(o.a,null,r.a.createElement(ye,{style:{background:"#fff",padding:0}},r.a.createElement(c.a,{className:"trigger",type:this.state.collapsed?"menu-unfold":"menu-fold",onClick:this.toggle}),r.a.createElement(X,{mainState:this.props.mainState,dispatch:this.props.dispatch})),r.a.createElement("div",{style:{margin:"24px 16px",padding:24,background:"#fff",minHeight:280}},e?this.renderContent(e):r.a.createElement($,null))))}}),Se=a(126),xe=a(122),ke=a.n(xe),Ie=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};let be,Ce={showLogin:!0,defaultRouter:"",userRoles:[]};var we=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};let De={sidebar:{open:!1,columnId:null},notify:{open:!0,message:"Hahah",header:"Heheh",type:"success"},savePanel:{open:!1},saveDesignNow:!1};var Te=a(162),Oe=a.n(Te);let _e=[u.UPDATE_STATE_DATA];var je=Object(Se.b)({main:Oe()((e=Ce,t)=>{switch(t.type){case u.START_APP:return be=ke()(e),be=Ie({},be,t.defaultProps);case u.UPDATE_STATE_DATA:return be=ke()(e),t.updateData&&t.updateData.showLogin&&sessionStorage.setItem("ISD_TOKEN",""),be=Ie({},be,t.updateData)}return e},{filter:(e,t,a)=>-1!==_e.indexOf(e.type),limit:100}),ui:(e=De,t)=>{switch(t.type){case u.UPDATE_UI:return we({},e,t.updateData);case u.TOGGLE_SAVE:return we({},e,{savePanel:{open:t.open}});case u.SAVE_DESIGN_NOW:return we({},e,{saveDesignNow:t.confirm||!1})}return e}});const Ne=Object(Se.c)(je);Ne.close=(()=>Ne.dispatch(END));var qe=Ne;const Ae=document.getElementById("isd_app");i.a.render(r.a.createElement(l.a,{store:qe},r.a.createElement(ve,null)),Ae)},345:function(e,t,a){e.exports=a(178)}});